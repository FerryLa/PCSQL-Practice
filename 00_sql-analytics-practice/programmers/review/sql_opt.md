### 5단 풀이법 적용 :
1. 문제의 요구사항을 파악
2. 문제를 한 줄 요약\
3. 어떤 논리 구조를 쓸지(테이블관계까지 파악, 1:1 1:N)
4. 풀이하면서 수정(JOIN 조건파악)
5. 문법 오류 & NULL 체크

### 확장된 9단계 버전 풀이법 :
1. 데이터 양/환경 가정하기 - "실무/서비스 DB인지, 문제사이트용 소규모 DB인지 가정.
    - 데이터가 크다고 가정하면: 인덱스 컬럼 위주로 JOIN/WHERE, 불필요한 정렬/서브쿼리 자제.
2. 실행 계획을 한 번은 보고, "풀스캔, 큰 해시 JOIN, 괜한 SORT가 있는지 정도만 체크.
    - IN vs EXISTS, JOIN vs 서브쿼리 교체 여지가 있는지 감으로만 판단.
3. 문제 요구사항 파악 - "어떤 단위로 보고 싶은가?" (예: 유저별? 주문별? 날짜별? 상품별?)
4. 한 줄 요약 - “어떤 집계 결과를 보고 싶은지”를 문장/수학식처럼 말로 정리
   (예: 유저별 첫 COMPLETED 주문 1건을 뽑고, 그 중 최근 30일을 날짜별로 집계)
5. 중간 결과가 필요한지 판단 (핵심!) - "최종 결과 한 줄이 무엇을 의미하는지"
   (핵심 단위와 최종 GROUP BY 단위 정하기) 
6. 중간 결과를 만드는 쿼리(CTE/subquery) 작성 - "이거 한방에 못간다.."
    ```
    “유저별로 가장 이른/가장 늦은/Top N 하나만 뽑기”
    예: 첫 구매, 마지막 로그인, 최근 주문 1건
    
    “A를 먼저 집계한 뒤 그 결과에 조건을 걸고 싶다”
    예: 유저별 총 주문 금액을 구하고, 그 중 10만원 이상인 유저만
    
    “같은 서브 로직을 여러 번 써야 한다”
    예: 같은 ‘활성 유저 집합’을 다른 쿼리에서 여러 번 조합
    
    “원본 테이블만 가지고 한 번에 GROUP BY로는 의미가 꼬인다”
    예: user_id 기준으로 집계도 해야 하고, 나중에 날짜 기준으로 또 집계해야 하는 문제

    “이 중간 결과에 이름을 붙여 설명하고 싶다” = CTE 후보
    예: 여기 active_users는 “최근 30일 내 로그인한 유저 집합”입니다
    ```
7. 그 중간 결과 기반으로 JOIN/GROUP BY (CTE? FROM? WHERE? JOIN?)
8. 최종 SELECT / GROUP BY 조립 - "중간 결과를 기반으로 필요한 쿼리만 남기고 최종 GROUP BY / 집계 함수 배치"
9. 문법/NULL 검증 및 성능 체크
    - 콤마, alias, BETWEEN 범위, 중복행, 같은 날 여러 주문, NULL 값 등
    - HARD : “이 테이블에 이상한 데이터가 있어도 결과가 버틸까?”까지 상상해보기

### 추가 : 
CTE (WITH) 쓸 타이밍
- 단계가 여러 개로 나뉘는 쿼리
- 중간 결과를 여러 번 재사용해야 할 때
- 길고 꼬인 서브쿼리 때문에 FROM이 지옥이 됐을 떄 (FROM절은 사실상 CTE랑 같지만 여러 절로 나뉘면 CTE를 선호)

WHERE 쓸 타이밍
- EXISTS / NOT EXISTS 패턴 : 값 가져오는 게 아니라, 존재 여부만 중요할 때
- IN / NOT IN 패턴 : "이 집합 안에 속하냐?"를 물을 때 (한 행당 하나의 값만 뽑을 때)

JOIN 쓸 타이밍
- "집계 결과를 컬럼으로 붙이기" 원본 테이블에 컬럼처럼 붙이고 싶다.
- "결과 행 수를 제어하고 싶다(1:N 허용/제한)"
-> 필요한 컬럼이 많거나, 집계 결과를 옆에 붙일 때
- EXISTS: "존재 여부만 궁금 + 서브쿼리에 메인쿼리 컬럼을 참조"일 때
- IN: "집함 크기가 작거나, 단순 equal 비교"일 때

EXISTS란?
SQL에서 "이 서브쿼리 조건을 만족하는 행이 하나라도 있냐?"를 참/거짓으로만 판단하는 조건 연산자
- EXISTS는 존재 여부만 확인
- 서브쿼리가 한 행이라도 반환하면 TRUE, 한 행도 없으면 FALSE
- 서브쿼리 안에서 SELECT 1이든 SELECT *이든 상관없고, "행이 나오느냐 안 나오느냐"만 봅니다.

`한 마디로 EXISTS는 SELECT 1이든 SELECT *이든 상관없이 'WHERE 내부컬럼 = 외부테이블컬럼'를 넣어 나타내는것`
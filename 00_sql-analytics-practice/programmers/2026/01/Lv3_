-- ID, COLONY_NAME, 분류된 사이즈 -> ID 오름차순

WITH TOTAL_SIZE AS (
    SELECT SUM(SIZE_OF_COLONY) AS SUM_SIZE FROM ECOLI_DATA
)
SELECT 
    E.ID, 
    CASE 
        WHEN (E.SIZE_OF_COLONY * 100.0 / T.SUM_SIZE) <= 25 THEN 'CRITICAL'
        WHEN (E.SIZE_OF_COLONY * 100.0 / T.SUM_SIZE) BETWEEN 26 AND 75 THEN 'LOW'
        ELSE 'HIGH'  -- 76 이상
    END AS COLONY_NAME
FROM ECOLI_DATA E
CROSS JOIN TOTAL_SIZE T
ORDER BY E.ID;

-- 오답 또 복기 필요